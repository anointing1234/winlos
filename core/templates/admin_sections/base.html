{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!-- ========== SEO & Page Identity ========== -->
    <title>The Winlos Academy | Nigeria’s Premier Christian Film School</title>
    <meta name="description" content="The Winlos Academy is Nigeria’s premier Christian film school, commissioning cultural influencers who create powerful, faith-driven stories with technical mastery and spiritual integrity. Discover the story you were born to tell.">
    <meta name="author" content="The Winlos Academy">
    <meta name="keywords" content="christian film school nigeria, winlos academy, faith-based filmmaking, christian cinematography training, bible-based film school, nigerian christian film academy, filmmaking with purpose, spiritual storytelling, rev otis ojukwu film school">
    <meta name="robots" content="index, follow">

    <!-- ========== Open Graph / Facebook ========== -->
    <meta property="og:title" content="The Winlos Academy | Nigeria’s Premier Christian Film School">
    <meta property="og:description" content="We don’t just train filmmakers — we commission cultural influencers. Join Nigeria’s leading Christian film school and create stories that illuminate, inspire, and transform culture for Christ.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.thewinlosacademy.com">
    <meta property="og:image" content="https://www.thewinlosacademy.com/assets/img/og-image.jpg' %}">
    <meta property="og:image:alt" content="The Winlos Academy - Christian Film School in Nigeria">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="The Winlos Academy">
    <meta property="og:locale" content="en_US">

    <!-- ========== Twitter Card ========== -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="The Winlos Academy | Christian Film School Nigeria">
    <meta name="twitter:description" content="At TWA, we help you discover the story you were born to tell. Join Nigeria’s premier Christian film school.">
    <meta name="twitter:image" content="https://www.thewinlosacademy.com/assets/img/og-image.jpg' %}">
    <meta name="twitter:site" content="@winlosacademy">
    <meta name="twitter:creator" content="@winlosacademy">
    
    
    <!-- ========== Favicon & Touch Icons ========== -->
    <link rel="shortcut icon" href="{% static 'assets/img/favicon.ico' %}" type="image/x-icon">
    <link rel="icon" href="{% static 'assets/img/favicon.ico' %}" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/img/apple-touch-icon.png' %}">

        <!-- Bootstrap -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/bootstrap.min.css' %}">
    <!-- file upload -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/file-upload.css' %}">
    <!-- file upload -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/plyr.css' %}">
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.min.css">
    <!-- full calendar -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/full-calendar.css' %}">
    <!-- jquery Ui -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/jquery-ui.css' %}">
    <!-- editor quill Ui -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/editor-quill.css' %}">
    <!-- apex charts Css -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/apexcharts.css' %}">
    <!-- calendar Css -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/calendar.css' %}">
    <!-- jvector map Css -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/jquery-jvectormap-2.0.5.css' %}">
    <!-- Main css -->
    <link rel="stylesheet" href="{% static 'dash_assets/css/main.css' %}">
<!-- Font Awesome CDN -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>


<style>
/* ============================= */
/* MODERN STUDENT MODAL STYLES  */
/* ============================= */
.student-modal {
    border-radius: 20px;
    overflow: hidden;
    background: #ffffff;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    font-family: 'Inter', sans-serif;
}

.student-modal .modal-header {
    border-bottom: none;
    padding-bottom: 0.5rem;
}

.student-modal .modal-title {
    font-size: 1.25rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.student-modal .btn-close {
    background: transparent;
    border: none;
    font-size: 1.25rem;
    opacity: 0.6;
    transition: all 0.3s;
}
.student-modal .btn-close:hover {
    opacity: 1;
    transform: scale(1.1);
}

.profile-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    overflow: hidden;
    border: 3px solid #28a745;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transition: all 0.3s;
}
.profile-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.profile-info h6 {
    font-weight: 700;
    margin-bottom: 0.25rem;
    font-size: 1.1rem;
}

.profile-info p {
    color: #6c757d;
    font-size: 0.875rem;
    margin-bottom: 0.25rem;
}

.modal-body hr {
    border-top: 1px solid rgba(0,0,0,0.08);
    margin: 1.5rem 0;
}

.info-card {
    background: linear-gradient(145deg, #f9f9f9, #e9ecef);
    padding: 1rem 1rem;
    border-radius: 12px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    transition: all 0.3s;
}

.info-card h6 {
    font-weight: 600;
    margin-bottom: 0.5rem;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.info-card p {
    font-size: 0.875rem;
    color: #6c757d;
    font-style: italic;
    margin-bottom: 0;
}

/* Hover / animation effects */
.profile-avatar:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
}

/* Smooth modal scroll */
.modal-dialog-scrollable .modal-body {
    max-height: 70vh;
    overflow-y: auto;
}

/* Responsive tweaks */
@media (max-width: 576px){
    .student-modal {
        margin: 1rem;
    }
    .profile-avatar {
        width: 80px;
        height: 80px;
    }
}
</style>

</head> 
<body>
    
<!--==================== Preloader Start ====================-->
  <div class="preloader">
    <div class="loader"></div>
  </div>
<!--==================== Preloader End ====================-->

<!--==================== Sidebar Overlay End ====================-->
<div class="side-overlay"></div>
<!--==================== Sidebar Overlay End ====================-->


{% include "./sections/navbar.html" %}
<div class="dashboard-main-wrapper">

   <!-- Top Navbar -->
<div class="top-navbar flex-between gap-16">
    <div class="flex-align gap-16">
        <!-- Toggle Button Start -->
        <button type="button" class="toggle-btn d-xl-none d-flex text-26 text-gray-500"><i class="ph ph-list"></i></button>
        <!-- Toggle Button End -->

        <!-- Search Form -->
        <div class="w-350 d-sm-block d-none">
            <div class="position-relative">
            <h4>Admin Portal Dashboard</h4>
            </div>
        </div>
    </div>

    <div class="flex-align gap-16">


        <!-- User Profile Dropdown -->
        <div class="dropdown">
            <button class="users arrow-down-icon border border-gray-200 rounded-pill p-4 d-inline-block pe-40 position-relative" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                <span class="position-relative">
                    {% if request.user.profile_pic and request.user.profile_pic.name %}
                    <img src="{{ request.user.profile_pic.url  }}" alt="Profile" class="h-32 w-32 rounded-circle">
                    {% else %}
                    <img src="{% static 'student_d_assets/images/profile_pic.png' %}" alt="Placeholder" class="h-32 w-32 rounded-circle">
                    {% endif %}
                    <span class="activation-badge w-8 h-8 position-absolute inset-block-end-0 inset-inline-end-0"></span>
                </span>
            </button>

            <div class="dropdown-menu dropdown-menu--lg border-0 bg-transparent p-0">
                <div class="card border border-gray-100 rounded-12 box-shadow-custom">
                    <div class="card-body">
                        <div class="flex-align gap-8 mb-20 pb-20 border-bottom border-gray-100">
                            {% if request.user.profile_pic and request.user.profile_pic.name %}
                            <img src="{{ request.user.profile_pic.url  }}" alt="Profile" class="w-54 h-54 rounded-circle">
                            {% else %}
                            <img src="{% static 'student_d_assets/images/profile_pic.png' %}" alt="Placeholder" class="w-54 h-54 rounded-circle">
                            {% endif %}
                            <div>
                                <h4 class="mb-0">{{ request.user.username }}</h4>
                                <p class="fw-medium text-13 text-gray-200">{{ request.user.email }}</p>
                            </div>
                        </div>
                        <ul class="max-h-270 overflow-y-auto scroll-sm pe-4">
                            <li class="mb-4">
                                <a href="{% url 'admin_profile' %}" class="py-12 text-15 px-20 hover-bg-gray-50 text-gray-300 rounded-8 flex-align gap-8 fw-medium">
                                    <span class="text-2xl text-primary-600 d-flex"><i class="ph ph-gear"></i></span>
                                    <span class="text">Account Settings</span>
                                </a>
                            </li>
                            <li class="pt-8 border-top border-gray-100">
                                <a href="{% url 'Admin_logout' %}" class="py-12 text-15 px-20 hover-bg-danger-50 text-gray-300 hover-text-danger-600 rounded-8 flex-align gap-8 fw-medium">
                                    <span class="text-2xl text-danger-600 d-flex"><i class="ph ph-sign-out"></i></span>
                                    <span class="text">Log Out</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- User Profile Dropdown End -->

    </div>
</div>


{% block contents %} {% endblock contents %}
{% include "./sections/footer.html" %} 
</div>





 <!-- Jquery js -->
<script src="{% static 'dash_assets/js/jquery-3.7.1.min.js' %}"></script>
<!-- Bootstrap Bundle JS (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Phosphor Js -->
    <script src="{% static 'dash_assets/js/phosphor-icon.js' %}"></script>
    <!-- file upload -->
    <script src="{% static 'dash_assets/js/file-upload.js' %}"></script>
    <!-- file upload -->
    <script src="{% static 'dash_assets/js/plyr.js' %}"></script>
    <!-- dataTables -->
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <!-- full calendar -->
    <script src="{% static 'dash_assets/js/full-calendar.js' %}"></script>
    <!-- jQuery UI -->
    <script src="{% static 'dash_assets/js/jquery-ui.js' %}"></script>
    <!-- jQuery UI -->
    <script src="{% static 'dash_assets/js/editor-quill.js' %}"></script>
   <!-- ApexCharts CDN -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts@3.49.1"></script>

    <!-- jvectormap Js -->
    <script src="{% static 'dash_assets/js/jquery-jvectormap-2.0.5.min.js' %}"></script>
    <!-- jvectormap world Js -->
    <script src="{% static 'dash_assets/js/jquery-jvectormap-world-mill-en.js' %}"></script>
    
    <!-- main js -->
    <script src="{% static 'dash_assets/js/main.js' %}"></script>


    <!-- ======================== -->
<!-- MODERN STUDENT MODAL HTML -->
<!-- ======================== -->
<div class="modal fade" id="studentModal" tabindex="-1" aria-labelledby="studentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm modal-dialog-scrollable">
        <div class="modal-content student-modal">

            <!-- Modal Header -->
            <div class="modal-header">
                <h5 class="modal-title" id="studentModalLabel">
                    <i class="ph ph-user text-success"></i> Student Profile
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body pt-3">

                <!-- Profile Section -->
                <div class="d-flex flex-column align-items-center text-center mb-4 profile-info">
                    <div class="profile-avatar mb-3">
                        <img id="modalProfilePic"
                             src="{% static 'student_d_assets/images/profile_pic.png' %}"
                             alt="Student Profile">
                    </div>
                    <h6 id="modalFullname">Full Name</h6>
                    <p id="modalEmail"><i class="ph ph-envelope me-1"></i>Email Address</p>
                    <p id="modalPhone"><i class="ph ph-phone me-1"></i>Phone Number</p>
                </div>

                <!-- Divider -->
                <hr>

                <!-- Additional Info -->
                <div class="info-card text-center">
                    <h6><i class="ph ph-info text-success"></i> Additional Information</h6>
                    <p id="modalAdditionalInfo">No additional information provided.</p>
                </div>

            </div>
        </div>
    </div>
</div>


<script>
document.addEventListener("DOMContentLoaded", function () {
    const spinner = document.getElementById("spinner");
    const rows = document.querySelectorAll("#studentTable tbody .student-row");
    const cards = document.querySelectorAll("#studentCards .student-card");
    const toggleBtnTable = document.getElementById("toggleStudentsBtn");
    const toggleBtnMobile = document.getElementById("loadMoreMobile");
    const countText = document.getElementById("studentCount");

    const INITIAL_VISIBLE = 4;
    let expanded = false;

    function updateView() {
        rows.forEach((row, i) => row.classList.toggle("d-none", !expanded && i >= INITIAL_VISIBLE));
        cards.forEach((card, i) => card.classList.toggle("d-none", !expanded && i >= INITIAL_VISIBLE));

        if (countText) {
            countText.textContent = expanded
                ? `Showing all ${rows.length} students`
                : `Showing 1–${Math.min(INITIAL_VISIBLE, rows.length)} of ${rows.length} students`;
        }
        if (toggleBtnTable) toggleBtnTable.textContent = expanded ? "See Less" : "See More";
        if (toggleBtnMobile) toggleBtnMobile.textContent = expanded ? "See Less" : "See More Students";
    }

    function toggleStudents() {
        spinner.classList.remove("d-none");
        setTimeout(() => {
            spinner.classList.add("d-none");
            expanded = !expanded;
            updateView();
        }, 600);
    }

    if (toggleBtnTable) toggleBtnTable.addEventListener("click", toggleStudents);
    if (toggleBtnMobile) toggleBtnMobile.addEventListener("click", toggleStudents);

    // Modal functionality
    const modalElement = document.getElementById('studentModal');
    const modal = new bootstrap.Modal(modalElement);

    document.querySelectorAll(".view-details").forEach(btn => {
        btn.addEventListener("click", function () {
            spinner.classList.remove("d-none");
            const studentId = this.dataset.studentId;
            const scriptTag = document.getElementById(`studentData-${studentId}`);

            setTimeout(() => {
                spinner.classList.add("d-none");
                if (!scriptTag) return;

                const student = JSON.parse(scriptTag.textContent);

                document.getElementById('modalProfilePic').src = student.profile_pic;
                document.getElementById('modalFullname').textContent = student.fullname || student.username;
                document.getElementById('modalEmail').textContent = student.email;
                document.getElementById('modalPhone').textContent = student.phone || "Not Provided";

              
                document.getElementById('modalAdditionalInfo').textContent = student.additional_info || 'No additional information.';

                modal.show();
            }, 600);
        });
    });

    updateView(); // Initial setup
});
</script>

<script>
var options = {
    series: [{ name: 'Income', data: Array(12).fill(0) }],
    chart: { type: 'bar', height: 400, stacked: true, toolbar: { show: false }, zoom: { enabled: true } },
    plotOptions: {
        bar: { columnWidth: "20%", borderRadius: 8, borderRadiusApplication: 'end', borderRadiusWhenStacked: 'last' }
    },
    dataLabels: { enabled: false },
    grid: { show: true, borderColor: '#d5dbe7', strokeDashArray: 3, position: 'back' },
    xaxis: { categories: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'] },
    yaxis: {
        labels: {
            offsetX: 12,
            maxWidth: 80,
            formatter: function(value) {
                if (value >= 1000) return "₦" + (value / 1000).toFixed(0) + "k";
                return "₦" + value;
            },
            style: { fontSize: "12px" }
        }
    },
    fill: { colors: ['#3D7FF9'] },
    legend: { show: false }
};

var chart = new ApexCharts(document.querySelector("#revenueGenerateChart"), options);
chart.render();

fetch("{% url 'revenue_chart_data' %}")
    .then(res => res.json())
    .then(data => {
        chart.updateSeries([{ name: 'Income', data: data.revenue }]);
    });
</script>




<script>
fetch("{% url 'revenue_chart_data' %}")
    .then(res => res.json())
    .then(data => {
        const container = document.querySelector('#revenueCardsMobile');
        container.innerHTML = ''; // clear any existing cards

        data.revenue.forEach((value, index) => {
            const month = data.months[index];
            const formattedValue = value >= 1000 
                ? "₦" + (value / 1000).toFixed(0) + "k" 
                : "₦" + value;

            // Bootstrap column for card
            const cardCol = document.createElement('div');
            cardCol.className = 'col-12'; // full width card for each month

            // Card element
            const card = document.createElement('div');
            card.className = `card shadow-sm ${value > 0 ? 'border-primary' : 'border-secondary'}`;
            card.style.borderWidth = '2px';

            card.innerHTML = `
                <div class="card-body d-flex justify-content-between align-items-center">
                    <span class="fw-medium text-muted">${month}</span>
                    <span class="fw-bold">${formattedValue}</span>
                </div>
            `;

            cardCol.appendChild(card);
            container.appendChild(cardCol);
        });
    });
</script>

    


   </body>
</html>